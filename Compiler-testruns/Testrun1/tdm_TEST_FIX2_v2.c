[DEBUG RENAME] Created rename_map with 2 entries
[DEBUG RENAME] Sample mappings:
[DEBUG RENAME]   t2_0 → local_0
[DEBUG RENAME]   t5_0 → local_0
[DEBUG RENAME] Created rename_map with 2 entries
[DEBUG RENAME] Sample mappings:
[DEBUG RENAME]   t13_0 → tmp
[DEBUG RENAME]   t44_0 → tmp1
[DEBUG RENAME] Variable 'local_0' has 2 versions:
[DEBUG RENAME]   Version 0: addr 13-13, type=temp, name=tmp
[DEBUG RENAME]   Version 1: addr 44-44, type=temp, name=tmp1
[DEBUG RENAME] Created rename_map with 0 entries
[DEBUG RENAME] Created rename_map with 210 entries
[DEBUG RENAME] Sample mappings:
[DEBUG RENAME]   t127_0 → tmp
[DEBUG RENAME]   t137_0 → tmp10
[DEBUG RENAME]   t142_0 → tmp14
[DEBUG RENAME]   phi_26_2_9 → local_8_v3
[DEBUG RENAME]   t145_0 → tmp14
[DEBUG RENAME]   t150_0 → tmp14
[DEBUG RENAME]   t160_0 → tmp15
[DEBUG RENAME]   t166_0 → tmp16
[DEBUG RENAME]   t167_0 → tmp16
[DEBUG RENAME]   t170_0 → local_8_v3
[DEBUG RENAME] Variable 'local_306' has 10 versions:
[DEBUG RENAME]   Version 0: addr 127-127, type=temp, name=tmp
[DEBUG RENAME]   Version 1: addr 224-224, type=temp, name=tmp1
[DEBUG RENAME]   Version 2: addr 331-331, type=temp, name=tmp2
[DEBUG RENAME]   Version 3: addr 360-360, type=temp, name=tmp3
[DEBUG RENAME]   Version 4: addr 578-578, type=temp, name=tmp4
[DEBUG RENAME]   Version 5: addr 584-584, type=temp, name=tmp5
[DEBUG RENAME]   Version 6: addr 605-605, type=temp, name=tmp6
[DEBUG RENAME]   Version 7: addr 646-646, type=temp, name=tmp7
[DEBUG RENAME]   Version 8: addr 739-739, type=temp, name=tmp8
[DEBUG RENAME]   Version 9: addr 757-757, type=temp, name=tmp9
[DEBUG RENAME] Variable 'local_307' has 4 versions:
[DEBUG RENAME]   Version 0: addr 137-137, type=temp, name=tmp10
[DEBUG RENAME]   Version 1: addr 185-185, type=temp, name=tmp11
[DEBUG RENAME]   Version 2: addr 232-232, type=temp, name=tmp12
[DEBUG RENAME]   Version 3: addr 243--1399, type=temp, name=tmp13
[DEBUG RENAME] Variable 'local_8' has 16 versions:
[DEBUG RENAME]   Version 0: addr 142-150, type=temp, name=tmp14
[DEBUG RENAME]   Version 1: addr 160-160, type=temp, name=tmp15
[DEBUG RENAME]   Version 2: addr 166-167, type=temp, name=tmp16
[DEBUG RENAME]   Version 3: addr 170-276, type=general, name=local_8_v3
[DEBUG RENAME]   Version 4: addr 284-284, type=temp, name=tmp17
[DEBUG RENAME]   Version 5: addr 287-287, type=temp, name=tmp18
[DEBUG RENAME]   Version 6: addr 294-294, type=temp, name=tmp19
[DEBUG RENAME]   Version 7: addr 300-300, type=temp, name=tmp20
[DEBUG RENAME]   Version 8: addr 309-309, type=temp, name=tmp21
[DEBUG RENAME]   Version 9: addr 316-317, type=temp, name=tmp22
[DEBUG RENAME]   Version 10: addr 320-529, type=general, name=local_8_v10
[DEBUG RENAME]   Version 11: addr 532-540, type=temp, name=tmp23
[DEBUG RENAME]   Version 12: addr 549-549, type=temp, name=tmp24
[DEBUG RENAME]   Version 13: addr 553-624, type=temp, name=tmp25
[DEBUG RENAME]   Version 14: addr 629-629, type=temp, name=tmp26
[DEBUG RENAME]   Version 15: addr 636--1406, type=temp, name=tmp27
[DEBUG RENAME] Variable 'local_9' has 4 versions:
[DEBUG RENAME]   Version 0: addr 176-176, type=temp, name=tmp28
[DEBUG RENAME]   Version 1: addr 181-181, type=temp, name=tmp29
[DEBUG RENAME]   Version 2: addr 188-188, type=temp, name=tmp30
[DEBUG RENAME]   Version 3: addr 218--1368, type=temp, name=tmp31
[DEBUG RENAME] Variable 'local_33' has 5 versions:
[DEBUG RENAME]   Version 0: addr 275-275, type=temp, name=tmp32
[DEBUG RENAME]   Version 1: addr 286-286, type=temp, name=tmp33
[DEBUG RENAME]   Version 2: addr 299-299, type=temp, name=tmp34
[DEBUG RENAME]   Version 3: addr 308-308, type=temp, name=tmp35
[DEBUG RENAME]   Version 4: addr 325--1379, type=temp, name=tmp36
[DEBUG RENAME] Variable 'local_13' has 14 versions:
[DEBUG RENAME]   Version 0: addr 371-371, type=temp, name=tmp37
[DEBUG RENAME]   Version 1: addr 376-376, type=temp, name=tmp38
[DEBUG RENAME]   Version 2: addr 380-380, type=temp, name=tmp39
[DEBUG RENAME]   Version 3: addr 387-387, type=temp, name=tmp40
[DEBUG RENAME]   Version 4: addr 394-394, type=temp, name=tmp41
[DEBUG RENAME]   Version 5: addr 401-401, type=temp, name=tmp42
[DEBUG RENAME]   Version 6: addr 408-408, type=temp, name=tmp43
[DEBUG RENAME]   Version 7: addr 413-413, type=temp, name=tmp44
[DEBUG RENAME]   Version 8: addr 418-418, type=temp, name=tmp45
[DEBUG RENAME]   Version 9: addr 425-425, type=temp, name=tmp46
[DEBUG RENAME]   Version 10: addr 432-432, type=temp, name=tmp47
[DEBUG RENAME]   Version 11: addr 439-439, type=temp, name=tmp48
[DEBUG RENAME]   Version 12: addr 446-446, type=temp, name=tmp49
[DEBUG RENAME]   Version 13: addr 450--1388, type=temp, name=tmp50
[DEBUG RENAME] Variable 'local_297' has 2 versions:
[DEBUG RENAME]   Version 0: addr 470-470, type=temp, name=tmp51
[DEBUG RENAME]   Version 1: addr 473--1392, type=temp, name=tmp52
[DEBUG RENAME] Variable 'local_0' has 2 versions:
[DEBUG RENAME]   Version 0: addr -212-499, type=temp, name=tmp53
[DEBUG RENAME]   Version 1: addr 514--1401, type=temp, name=tmp54
[DEBUG RENAME] Variable 'local_12' has 2 versions:
[DEBUG RENAME]   Version 0: addr 612-612, type=temp, name=tmp55
[DEBUG RENAME]   Version 1: addr 641-641, type=temp, name=tmp56
[DEBUG RENAME] Variable 'local_28' has 4 versions:
[DEBUG RENAME]   Version 0: addr 653-653, type=temp, name=tmp57
[DEBUG RENAME]   Version 1: addr 656-656, type=temp, name=tmp58
[DEBUG RENAME]   Version 2: addr 669-669, type=temp, name=tmp59
[DEBUG RENAME]   Version 3: addr 672--1422, type=temp, name=tmp60
[DEBUG RENAME] Variable 'local_10' has 2 versions:
[DEBUG RENAME]   Version 0: addr 659-659, type=temp, name=tmp61
[DEBUG RENAME]   Version 1: addr 683-683, type=temp, name=tmp62
[DEBUG RENAME] Variable 'local_11' has 10 versions:
[DEBUG RENAME]   Version 0: addr 675-675, type=temp, name=tmp63
[DEBUG RENAME]   Version 1: addr 680-680, type=temp, name=tmp64
[DEBUG RENAME]   Version 2: addr 684-684, type=temp, name=tmp65
[DEBUG RENAME]   Version 3: addr 688-688, type=temp, name=tmp66
[DEBUG RENAME]   Version 4: addr 694-694, type=temp, name=tmp67
[DEBUG RENAME]   Version 5: addr 702-702, type=temp, name=tmp68
[DEBUG RENAME]   Version 6: addr 710-710, type=temp, name=tmp69
[DEBUG RENAME]   Version 7: addr 715-715, type=temp, name=tmp70
[DEBUG RENAME]   Version 8: addr 721-721, type=temp, name=tmp71
[DEBUG RENAME]   Version 9: addr 729-729, type=temp, name=tmp72
// Structured decompilation of Compiler-testruns\Testrun1\tdm.scr
// Functions: 4

#include <inc\sc_global.h>
#include <inc\sc_def.h>
#include <inc\mplevel.inc>

// Global variables
dword gRecs;
dword gRec;
dword gVar;
dword gVar1;
dword gRecTimer;
dword gNextRecover;
dword gSideFrags[2];
dword gCLN_SideFrags[2];
dword gEndRule;
dword gEndValue;
dword gTime;
dword gPlayersConnected;
dword gVar4;
dword gVar2;
dword gVar3;

int _init(s_SC_NET_info *info) {
    int local_0;

    DLD();
    DLD();
    return FALSE;
}

int func_0010(float time) {
    int local_0;

    switch (gEndRule) {
    case 0:
        if (((gPlayersConnected > 0))) {
            gTime = (gTime + time);
        }
        SC_MP_EndRule_SetTimeLeft(gTime, (gPlayersConnected > 0));
        if (((gTime > ITOF(gEndValue)))) {
            SC_MP_LoadNextMap();
            return TRUE;
        }
        break;
    case 1:
        if (((gSideFrags[0] > 0))) {
            if (((gSideFrags[0] >= gEndValue))) {
            } else {
                if (((gSideFrags[1] > 1))) {
                    if (((gSideFrags[1] >= gEndValue))) {
                        SC_MP_LoadNextMap();
                        return TRUE;
                    }
                }
                SC_message("EndRule unsopported: %d", gEndRule);
                return FALSE;
            }
        }
        break;
    default:
    }
}

int func_0096(void) {
    SC_sgi(GVAR_SIDE0FRAGS, gSideFrags[0]);
    SC_sgi(GVAR_SIDE1FRAGS, gSideFrags[1]);
    return FALSE;
}

int ScriptMain(s_SC_NET_info *info) {
    char local_0[32];
    dword local_13[16];
    int i;
    int j;
    int local_10;
    int local_12;
    int local_297;
    int local_306;
    int local_307;
    int local_33;
    int local_41;
    int local_9;
    s_SC_P_getinfo player_info;

    switch (info->message) {
    case 3:
        if ((func_0010(info->field_16))) break;
        *tmp14 = 0;
        // Loop header - Block 26 @145
        for (tmp14 = 0; (tmp14 < gRecs); tmp14 = (tmp16 + 1)) {
            gRecTimer[tmp15] = (gRecTimer[tmp14] - info->field_16);
            *local_8_v3 = (tmp16 + 1);
        }
        *tmp28 = 64;
        if ((SC_MP_EnumPlayers(local_41, tmp29, -1))) {
            if (((tmp30 == 0))) {
                if ((((gSideFrags[0] + gSideFrags[1]) != 0))) {
                    gSideFrags[0] = 0;
                    gSideFrags[1] = 0;
                    func_0096();
                }
            }
        }
        gPlayersConnected = tmp31;
        break;
    case 4:
        gCLN_SideFrags[0] = SC_ggi(GVAR_SIDE0FRAGS);
        gCLN_SideFrags[1] = SC_ggi(GVAR_SIDE1FRAGS);
        SC_MP_SetSideStats(0, gCLN_SideFrags[0], 0);
        SC_MP_SetSideStats(1, gCLN_SideFrags[1], 0);
        *local_8_v3 = 0;
        // Loop header - Block 36 @270
        for (local_8_v3 = 0; (local_8_v3 < 2); local_8_v3 = (tmp22 + 1)) {
            local_33[local_8_v3].field1 = 1;
            local_33[tmp18] = (3 * tmp17);
            local_33[tmp20].field2 = gCLN_SideFrags[tmp19];
            local_33[tmp21].field3 = -1;
            *local_8_v10 = (tmp22 + 1);
        }
        SC_MP_SetIconHUD(tmp36, 2);
        break;
    case 9:
        SC_sgi(GVAR_MP_MISSIONTYPE, 2);
        gEndRule = info->field_4;
        gEndValue = info->field_8;
        gTime = 0;
        SC_MP_EnableBotsFromScene(0);
        break;
    case 1:
        SC_MP_SRV_SetForceSide(-1);
        SC_MP_SetChooseValidSides(3);
        SC_MP_SRV_SetClassLimitsForDM();
        SC_ZeroMem(tmp37, 60);
        *tmp38 = 1051;
        (tmp39 + 40) = 2;
        ((tmp40 + 40) + 4) = 3;
        ((tmp41 + 40) + 8) = -2147483644;
        ((tmp42 + 40) + 12) = -2147483643;
        *(tmp43 + 32) = 28;
        *(tmp44 + 4) = 1;
        (tmp45 + 16) = 1010;
        ((tmp47 + 16) + 4) = 1011;
        *(tmp49 + 36) = 2;
        SC_MP_HUD_SetTabInfo(tmp50);
        SC_MP_AllowStPwD(1);
        SC_MP_AllowFriendlyFireOFF(1);
        SC_MP_SetItemsNoDisappear(0);
        if ((info->field_8)) {
            if ((info->field_4)) {
                SC_MP_GetSRVsettings(tmp51);
                SC_MP_SRV_InitWeaponsRecovery(ITOF((*(tmp52 + 8))));
                SC_MP_Gvar_SetSynchro(500);
                SC_MP_Gvar_SetSynchro(501);
                func_0096();
                gRecs = 0;
                *local_8_v10 = 0;
                sprintf(tmp53, "DM%d", local_8_v10);
                if ((SC_NET_FillRecover(&gRec[gRecs], tmp54))) {
                    gRecs++;
                } else {
                    *tmp23 = (local_8_v10 + 1);
                }
                *tmp23 = (64 - gRecs);
                SC_MP_GetRecovers(1, &gRec[gRecs], tmp24);
                gRecs = (gRecs + tmp25);
                SC_Log(3, "TDM respawns: %d", gRecs);
                if (((gRecs == 0))) {
                    SC_message("no recover place defined!");
                }
                SC_ZeroMem(&gRecTimer, 256);
            }
        }
        // Loop header - Block 45 @494
        for (local_8_v10 = 0; (local_8_v10 < 64); local_8_v10 = (local_8_v10_v10 + 1)) {
            *tmp23 = (local_8_v10 + 1);
        }
        break;
    case 2:
        break;
    case 5:
        if ((info->field_8)) {
        } else {
        }
        break;
    case 6:
        *tmp55 = info->field_8;
        *tmp25 = SC_MP_SRV_GetBestDMrecov(&gRec, gRecs, &gRecTimer, 3.0f);
        gRecTimer[tmp26] = 3.0f;
        tmp56 = gRec[tmp27];
        break;
    case 7:
        SC_P_GetInfo(info->field_4, tmp57);
        *tmp61 = local_28.side;
        if ((info->field_8)) {
            SC_P_GetInfo(info->field_8, tmp59);
            *tmp63 = local_28.side;
        } else {
            *tmp64 = -1;
        }
        if (((tmp62 == tmp65))) {
            gSideFrags[tmp68] = (gSideFrags[tmp67] - 1);
        } else {
            if (((tmp69 != -1))) {
                gSideFrags[tmp72] = (gSideFrags[tmp71] + 1);
            }
        }
        func_0096();
        break;
    case 10:
        gTime = 0;
        SC_ZeroMem(&gSideFrags, 8);
        func_0096();
        SC_MP_SRV_ClearPlsStats();
        SC_MP_SRV_InitGameAfterInactive();
        SC_MP_RecoverAllNoAiPlayers();
        break;
    case 11:
        gEndRule = info->field_4;
        gEndValue = info->field_8;
        gTime = 0;
        break;
    default:
        return TRUE;
    }
}

